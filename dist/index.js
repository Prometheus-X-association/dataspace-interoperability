"use strict";var xt=Object.create;var q=Object.defineProperty,Rt=Object.defineProperties,It=Object.getOwnPropertyDescriptor,vt=Object.getOwnPropertyDescriptors,St=Object.getOwnPropertyNames,ut=Object.getOwnPropertySymbols,wt=Object.getPrototypeOf,ht=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var ft=(n,t,e)=>t in n?q(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,u=(n,t)=>{for(var e in t||(t={}))ht.call(t,e)&&ft(n,e,t[e]);if(ut)for(var e of ut(t))At.call(t,e)&&ft(n,e,t[e]);return n},y=(n,t)=>Rt(n,vt(t));var Ot=(n,t)=>{for(var e in t)q(n,e,{get:t[e],enumerable:!0})},yt=(n,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of St(t))!ht.call(n,r)&&r!==e&&q(n,r,{get:()=>t[r],enumerable:!(s=It(t,r))||s.enumerable});return n};var gt=(n,t,e)=>(e=n!=null?xt(wt(n)):{},yt(t||!n||!n.__esModule?q(e,"default",{value:n,enumerable:!0}):e,n)),Tt=n=>yt(q({},"__esModule",{value:!0}),n);var b=(n,t,e)=>new Promise((s,r)=>{var a=c=>{try{o(e.next(c))}catch(d){r(d)}},i=c=>{try{o(e.throw(c))}catch(d){r(d)}},o=c=>c.done?s(c.value):Promise.resolve(c.value).then(a,i);o((e=e.apply(n,t)).next())});var Ct={};Ot(Ct,{Catalog:()=>ct,Checksum:()=>mt,ContractTemplate:()=>st,DSPDistribution:()=>I,DataCatalog:()=>j,DataOffering:()=>H,DataProduct:()=>J,DataProductUsageContract:()=>dt,DataRepresentation:()=>A,DataResource:()=>C,DataSet:()=>_,DataTransaction:()=>pt,DcatToPtxConvertor:()=>it,Distribution:()=>B,EdcCatalog:()=>N,EdcDataService:()=>U,EdcDataset:()=>z,EdcDistribution:()=>k,EdcToPtxConvertor:()=>nt,GaiaXToPtxConvertor:()=>Y,PtxToDcatConvertor:()=>et,PtxToEdcConvertor:()=>ot,PtxToGaiaXConvertor:()=>W,PtxToSimplConvertor:()=>rt,Resource:()=>w,ServiceOffering:()=>E,SimplToPtxConvertor:()=>at,SoftwareResource:()=>L});module.exports=Tt(Ct);var Dt=gt(require("axios"));var w=class{toJSON(){return{"@id":this["@id"],"@context":this["@context"],"@type":this["@type"],"dcterms:title":this["dcterms:title"],"dcterms:description":this["dcterms:description"],"dcterms:accessRights":this["dcterms:accessRights"],"dcterms:conformsTo":this["dcterms:conformsTo"],"dcat:contactPoint":this["dcat:contactPoint"],"dcterms:creator":this["dcterms:creator"],"dcterms:issued":this["dcterms:issued"],"dcterms:modified":this["dcterms:modified"],"dcterms:language":this["dcterms:language"],"dcterms:publisher":this["dcterms:publisher"],"dcterms:identifier":this["dcterms:identifier"],"dcat:theme":this["dcat:theme"],"dcterms:type":this["dcterms:type"],"dcterms:relation":this["dcterms:relation"],"dcat:qualifiedRelation":this["dcat:qualifiedRelation"],"dcat:keyword":this["dcat:keyword"],"dcat:landingPage":this["dcat:landingPage"],"prov:qualifiedAttribution":this["prov:qualifiedAttribution"],"dcterms:license":this["dcterms:license"],"dcterms:rights":this["dcterms:rights"],"dcterms:hasPart":this["dcterms:hasPart"],"odrl:hasPolicy":this["odrl:hasPolicy"],"dcterms:isReferencedBy":this["dcterms:isReferencedBy"],"dcat:previousVersion":this["dcat:previousVersion"],"dcat:hasVersion":this["dcat:hasVersion"],"dcat:hasCurrentVersion":this["dcat:hasCurrentVersion"],"dcterms:replaces":this["dcterms:replaces"],"dcat:version":this["dcat:version"],"adms:versionNotes":this["adms:versionNotes"],"adms:status":this["adms:status"],"dcat:first":this["dcat:first"],"dcat:last":this["dcat:last"],"dcat:prev":this["dcat:prev"]}}};var J=class extends w{constructor(t){super(),Object.assign(this,t)}toJSON(){return y(u({},super.toJSON()),{"gx:providedBy":this["gx:providedBy"],"gx:termsAndConditions":this["gx:termsAndConditions"],"dct:license":this["dct:license"],"gx:title":this["gx:title"],"gx:description":this["gx:description"],"dct:issued":this["dct:issued"],"gx:obsoleteDateTime":this["gx:obsoleteDateTime"],"gx:dataLicensors":this["gx:dataLicensors"],"gx:dataUsageAgreement":this["gx:dataUsageAgreement"],"gx:aggregationOf":this["gx:aggregationOf"],"dct:identifier":this["dct:identifier"]})}};var x=class extends w{toJSON(){return y(u({},super.toJSON()),{"dcat:distribution":this["dcat:distribution"],"dcterms:accrualPeriodicity":this["dcterms:accrualPeriodicity"],"dcat:inSeries":this["dcat:inSeries"],"dcterms:spatial":this["dcterms:spatial"],"dcat:spatialResolutionInMeters":this["dcat:spatialResolutionInMeters"],"dcterms:temporal":this["dcterms:temporal"],"dcat:temporalResolution":this["dcat:temporalResolution"]})}};var _=class extends x{constructor(t){super(),Object.assign(this,t)}toJSON(){var t;return y(u({},super.toJSON()),{"@type":this["@type"],"dcterms:title":this["dct:title"],"dcterms:description":this["dct:description"],"dct:title":this["dct:title"],"dct:description":this["dct:description"],"dct:distributions":this["dct:distributions"],"dct:identifier":this["dct:identifier"],"dct:issued":this["dct:issued"],"gx:expirationDateTime":this["gx:expirationDateTime"],"dct:license":this["dct:license"],"gx:dataLicensors":this["gx:dataLicensors"],"gx:dataUsageAgreement":(t=this["gx:dataUsageAgreement"])==null?void 0:t.map(e=>e.toJSON()),"gx:exposedThrough":this["gx:exposedThrough"]})}};var K=class{constructor(t){this.account=t.account||""}};var M=class{constructor(t){this.name=t.name||"",this.homepage=t.homepage||""}};var G=class{constructor(t){this.name=t.name||"",this.homepage=t.homepage||""}};var v;(s=>{class n extends K{}s.Agent=n;class t extends M{}s.Person=t;class e extends G{}s.Organization=e})(v||(v={}));var I=class{toJSON(){return{"@id":this["@id"],"@type":this["@type"],"dcterms:title":this["dcterms:title"],"dcterms:description":this["dcterms:description"],"dcterms:issued":this["dcterms:issued"],"dcterms:modified":this["dcterms:modified"],"dcterms:license":this["dcterms:license"],"dcterms:accessRights":this["dcterms:accessRights"],"dcterms:rights":this["dcterms:rights"],"odrl:hasPolicy":this["odrl:hasPolicy"],"dcat:accessURL":this["dcat:accessURL"],"dcat:downloadURL":this["dcat:downloadURL"],"dcat:accessService":this["dcat:accessService"],"dcat:byteSize":this["dcat:byteSize"],"dcat:spatialResolutionInMeters":this["dcat:spatialResolutionInMeters"],"dcat:temporalResolution":this["dcat:temporalResolution"],"dcterms:conformsTo":this["dcterms:conformsTo"],"dcat:mediaType":this["dcat:mediaType"],"dcterms:format":this["dcterms:format"],"dcat:compressFormat":this["dcat:compressFormat"],"dcat:packageFormat":this["dcat:packageFormat"]}}};var B=class extends I{constructor(t){super(),Object.assign(this,t)}toJSON(){var t;return y(u({},super.toJSON()),{"dct:title":this["dct:title"],"dct:format":this["dct:format"],"gx:location":this["gx:location"],"gx:hash":this["gx:hash"],"gx:hashAlgorithm":this["gx:hashAlgorithm"],"dct:issued":this["dct:issued"],"gx:expirationDateTime":this["gx:expirationDateTime"],"dcat:language":this["dcat:language"],"dct:license":this["dct:license"],"gx:dataLicensors":this["gx:dataLicensors"],"gx:dataUsageAgreement":(t=this["gx:dataUsageAgreement"])==null?void 0:t.map(e=>e.toJSON())})}};var $=class{};var F;(t=>{class n extends ${}t.Kind=n})(F||(F={}));var T=class extends x{toJSON(){return y(u({},super.toJSON()),{"foaf:homepage":this["foaf:homepage"],"dcat:themeTaxonomy":this["dcat:themeTaxonomy"],"dcat:resource":this["dcat:resource"],"dcat:dataset":this["dcat:dataset"],"dcat:service":this["dcat:service"],"dcat:catalog":this["dcat:catalog"]})}};var j=class extends T{constructor(t){super(),this["gx-trust-framework:getVerifiableCredentialsIDs"]=t["gx-trust-framework:getVerifiableCredentialsIDs"]}toJSON(){return y(u({},super.toJSON()),{"gx-trust-framework:getVerifiableCredentialsIDs":this["gx-trust-framework:getVerifiableCredentialsIDs"]})}};var X=class{constructor(t){this.inScheme=new R.ConceptScheme({}),this.topConceptOf=new R.ConceptScheme({}),this.definition=t.definition}};var Q=class{constructor(t){this.themes=t.themes||[],this.themeTaxonomy=t.themeTaxonomy||""}};var R;(e=>{class n extends X{}e.Concept=n;class t extends Q{}e.ConceptScheme=t})(R||(R={}));var V=class extends w{};var W=class{mapDataResourceToDataSet(t){var r,a,i,o,c,d,p,m,g,D;let e=new _({"dct:distributions":[],"dct:identifier":t._id,"dct:description":t.description,"dct:issued":(r=t.createdAt)==null?void 0:r.toString(),"dct:license":t.license,"dct:title":t.name,"gx:dataLicensors":[],"gx:dataUsageAgreement":[],"gx:expirationDateTime":void 0,"gx:exposedThrough":[]});e["@id"]=t._id,e["odrl:hasPolicy"]=t.policy,e["@type"]="DataResource",e["dcterms:rights"]=t.copyrightOwnedBy,e["dcterms:creator"]=new v.Agent({account:t.producedBy});let s=new R.ConceptScheme({themes:[],themeTaxonomy:""});if(e["dcat:theme"]=new R.Concept({inScheme:s,topConceptOf:s,definition:t.category}),t.representation){[].push((i=(a=t.representation)==null?void 0:a.url)!=null?i:"");let h=new B({"dcat:language":"","dct:format":"","dct:issued":t.representation.createdAt,"dct:license":t.license,"dct:title":t.name,"gx:dataLicensors":t.producedBy,"gx:dataUsageAgreement":[],"gx:expirationDateTime":"","gx:hash":"","gx:hashAlgorithm":"","gx:location":t.country_or_region});h["@id"]=(o=t.representation)==null?void 0:o._id,h["@type"]="ptx:representation",h["dcterms:issued"]=(c=t.representation)==null?void 0:c.createdAt,h["dcterms:modified"]=(d=t.representation)==null?void 0:d.updatedAt,h["dcterms:accessRights"]=(p=t.representation)==null?void 0:p.method,h["dcterms:rights"]=(m=t.representation)==null?void 0:m.credential,h["dcat:mediaType"]=(g=t.representation)==null?void 0:g.type,h["dcat:accessURL"]=(D=t.representation)==null?void 0:D.url,e["dct:distributions"].push(h)}if(t.apiResponseRepresentation){let f=new B({"dcat:language":"","dct:format":"","dct:issued":t.apiResponseRepresentation.createdAt,"dct:license":t.license,"dct:title":t.name,"gx:dataLicensors":t.producedBy,"gx:dataUsageAgreement":[],"gx:expirationDateTime":"","gx:hash":"","gx:hashAlgorithm":"","gx:location":t.country_or_region});f["@id"]=t.apiResponseRepresentation._id,f["@type"]="ptx:apiResponseRepresentation",f["dcterms:modified"]=t.apiResponseRepresentation.updatedAt,f["dcterms:accessRights"]=t.apiResponseRepresentation.method,f["dcterms:rights"]=t.apiResponseRepresentation.credential,f["dcat:mediaType"]=t.apiResponseRepresentation.type,e["dct:distributions"].push(f)}return e}mapSoftwareResourceToDataSet(t){var a;let e=new _({"dct:description":t.description,"dct:distributions":[],"dct:identifier":(a=t._id)!=null?a:"","dct:issued":t.createdAt,"dct:license":t.license,"dct:title":t.name,"gx:dataLicensors":t.providedBy,"gx:dataUsageAgreement":[],"gx:expirationDateTime":void 0,"gx:exposedThrough":[]});e["@id"]=t._id,e["@type"]="SoftwareResource",e["dcterms:modified"]=t.updatedAt,e["dcat:version"]=t.schema_version,e["odrl:hasPolicy"]=t.policy,e["dcterms:creator"]=new v.Agent({account:t.providedBy});let s=new R.ConceptScheme({themes:[],themeTaxonomy:""});e["dcat:theme"]=new R.Concept({inScheme:s,topConceptOf:s,definition:t.category}),e["dcterms:rights"]=t.copyrightOwnedBy,e["dcterms:hasPart"]=(t.aggregationOf||[]).map(i=>{let o=new _({"dct:description":"","dct:distributions":[],"dct:identifier":"","dct:title":"","gx:exposedThrough":[]});return o["@id"]=i,o});let r=t.locationAddress.map(i=>i.countryCode);if(e["dcterms:language"]=r.join(";"),t.representation){let i=new B({"dcat:language":"","dct:format":"","dct:issued":"","dct:license":[],"dct:title":"","gx:dataLicensors":[],"gx:dataUsageAgreement":[],"gx:expirationDateTime":"","gx:hash":"","gx:hashAlgorithm":"","gx:location":t.country_or_region||[]});i["@id"]=t.representation._id,i["@type"]="ptx:representation",i["dcat:accessURL"]=t.representation.url,i["dcterms:modified"]=t.representation.updatedAt,i["dcterms:accessRights"]=t.representation.method,i["dcterms:rights"]=t.representation.credential,i["dcat:mediaType"]=t.representation.type,e["dct:distributions"].push(i)}return e}mapServiceOfferingToDataProduct(t){return b(this,null,function*(){var o,c,d,p,m,g,D,f;let e=new v.Agent({account:(o=t.providedBy)!=null?o:""});e.account=(c=t.providedBy)!=null?c:"";let s=new F.Kind;s.url=(d=t.dependsOn)!=null?d:"";let r=[],a=[];for(let h of t.aggregationOf){let S=yield Dt.default.get(h),O=new V;if(O["dcat:hadRole"]=S.data["@type"],O["dcterms:relation"]=h,O["dcterms:description"]=S.data.description,a.push(O),S.data["@type"]==="DataResource"){let l=this.mapDataResourceToDataSet(S.data);r.push(l)}else{let l=this.mapSoftwareResourceToDataSet(S.data);r.push(l)}}let i=new J({"dct:identifier":(p=t._id)!=null?p:"","dct:license":[],"gx:aggregationOf":r,"gx:providedBy":(m=t.providedBy)!=null?m:"","gx:termsAndConditions":t.termsAndConditions,"gx:title":(g=t.name)!=null?g:"","gx:description":(D=t.description)!=null?D:"","odrl:hasPolicy":t.policy,"dct:issued":t.createdAt,"dcat:contactPoint":s,"dcterms:conformsTo":t.termsAndConditions,"gx:obsoleteDateTime":void 0,"gx:dataLicensors":[],"gx:dataUsageAgreement":[]});return i["@type"]="ServiceOffering",i["dcterms:modified"]=t.updatedAt,i["dcat:version"]=t.schema_version,i["dcat:keyword"]=t.keywords.join(";")&&t.category.join(";"),i["gx:aggregationOf"]=r,i["dcterms:creator"]=e,i["dcat:qualifiedRelation"]=a,i["dcterms:creator"]=new v.Agent({account:(f=t.providedBy)!=null?f:""}),i["dcat:contactPoint"]=new F.Kind,i["dcat:contactPoint"].url=t.dependsOn,i["dcterms:conformsTo"]=t.termsAndConditions,i})}mapServiceOfferings(t){return b(this,null,function*(){let e=[];for(let s of t)e.push(yield this.mapServiceOfferingToDataProduct(s));return e})}mapResources(t,e){let s=[];for(let r of t)s.push(this.mapDataResourceToDataSet(r));for(let r of e)s.push(this.mapSoftwareResourceToDataSet(r));return s}mapPtxCatalogToGaiaXCatalog(t){return b(this,null,function*(){let e=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="serviceoffering"}),s=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="dataresource"}),r=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="softwareresource"}),a=new j({"gx-trust-framework:getVerifiableCredentialsIDs":t.map(i=>i._id).join(",")});return a["@context"]="https://w3id.org/dspace/2024/1/context.json",a["@type"]="dcat:Catalog",a["dcat:resource"]=yield this.mapServiceOfferings(e),a["dcat:dataset"]=this.mapResources(s,r),a["foaf:homepage"]="catalog/offers",a})}};var C=class{constructor(t){Object.assign(this,t)}toJSON(){return{representation:this.representation,apiResponseRepresentation:this.apiResponseRepresentation,createdAt:this.createdAt,updatedAt:this.updatedAt,name:this.name,description:this.description,license:this.license,policy:this.policy,producedBy:this.producedBy,schema_version:this.schema_version,country_or_region:this.country_or_region,copyrightOwnedBy:this.copyrightOwnedBy,category:this.category,subCategories:this.subCategories,exposedThrough:this.exposedThrough}}};var L=class{constructor(t){Object.assign(this,t)}toJSON(){return{_id:this._id,representation:this.representation,apiResponseRepresentation:this.apiResponseRepresentation,createdAt:this.createdAt,updatedAt:this.updatedAt,name:this.name,description:this.description,license:this.license,policy:this.policy,schema_version:this.schema_version,country_or_region:this.country_or_region,copyrightOwnedBy:this.copyrightOwnedBy,category:this.category,subCategories:this.subCategories,exposedThrough:this.exposedThrough,providedBy:this.providedBy,aggregationOf:this.aggregationOf,locationAddress:this.locationAddress,demo_link:this.demo_link}}};var E=class{constructor(t){Object.assign(this,t)}toJSON(){return{_id:this._id,name:this.name,providedBy:this.providedBy,description:this.description,createdAt:this.createdAt,updatedAt:this.updatedAt,schema_version:this.schema_version,policy:this.policy,keywords:this.keywords,category:this.category,dataResources:this.dataResources,softwareResources:this.softwareResources,location:this.location,aggregationOf:this.aggregationOf,dependsOn:this.dependsOn,termsAndConditions:this.termsAndConditions}}};var A=class{constructor(t){Object.assign(this,t)}toJSON(){return{_id:this._id,type:this.type,resourceID:this.type,url:this.url,method:this.method,credential:this.credential,createdAt:this.createdAt,updatedAt:this.updatedAt,input:this.input,output:this.output,processingTime:this.processingTime}}};var Y=class{mapDataSetToDataResource(t){var r,a;if(!t["@id"])throw new Error("dataSet must have an @id property");let e=new C({_id:t["dct:identifier"],name:t["dct:title"],description:t["dct:description"],createdAt:t["dct:issued"],updatedAt:t["dcterms:modified"],license:t["dct:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],producedBy:(r=t["dcterms:creator"])==null?void 0:r.account,category:(a=t["dcat:theme"])==null?void 0:a.definition,copyrightOwnedBy:t["dcterms:rights"],exposedThrough:t["gx:exposedThrough"]}),s=t["dct:distributions"];if(Array.isArray(s))for(let i of s){let o=new A({_id:i["@id"],resourceID:t["@id"],url:Array.isArray(i["dcat:accessURL"])?i["dcat:accessURL"][0]:i["dcat:accessURL"],createdAt:i["dct:issued"],updatedAt:i["dcterms:modified"],method:i["dcterms:accessRights"],credential:i["dcterms:rights"],type:i["dcat:mediaType"]});e.representation?e.apiResponseRepresentation||(e.apiResponseRepresentation=o):e.representation=o}return e}mapDataSetToSoftwareResource(t){var r,a;if(!t["@id"])throw new Error("resource must have an @id property");let e=new L({_id:t["@id"],name:t["dct:title"],description:t["dct:description"],createdAt:t["dct:issued"],updatedAt:t["dcterms:modified"],license:t["dct:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],providedBy:(r=t["dcterms:creator"])==null?void 0:r.account,category:(a=t["dcat:theme"])==null?void 0:a.definition,copyrightOwnedBy:t["dcterms:rights"],exposedThrough:t["gx:exposedThrough"]}),s=t["dct:distributions"];if(Array.isArray(s))for(let i of s){let o=new A({_id:i["@id"],resourceID:t["@id"],url:Array.isArray(i["dcat:accessURL"])?i["dcat:accessURL"][0]:i["dcat:accessURL"],createdAt:i["dct:issued"],updatedAt:i["dcterms:modified"],method:i["dcterms:accessRights"],credential:i["dcterms:rights"],type:i["dcat:mediaType"]});e.representation?e.apiResponseRepresentation||(e.apiResponseRepresentation=o):e.representation=o}return e}mapDataProductToServiceOffering(t){return b(this,null,function*(){var r,a;if(!t["@id"])throw new Error("resource must have an @id property");let e=new E({_id:t["@id"],name:t["gx:title"],description:t["gx:description"],createdAt:t["dct:issued"],updatedAt:t["dcterms:modified"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],providedBy:(r=t["dcterms:creator"])==null?void 0:r.account,category:(a=t["dcat:theme"])==null?void 0:a.definition,termsAndConditions:t["dcterms:conformsTo"]});e.dataResources=[],e.softwareResources=[];let s=t["gx:aggregationOf"];if(Array.isArray(s))for(let i of s)if(i["@type"]==="DataResource"){let o=this.mapDataSetToDataResource(i);e.dataResources.push(o)}else{let o=this.mapDataSetToSoftwareResource(i);e.softwareResources.push(o)}return e})}mapGaiaXCatalogToPtxCatalog(t){return b(this,null,function*(){let e=[],s=[],r=[];if(t["dcat:resource"]&&Array.isArray(t["dcat:resource"]))for(let a of t["dcat:resource"]){let i=yield this.mapDataProductToServiceOffering(a);e.push(i)}if(t["dcat:dataset"]&&Array.isArray(t["dcat:dataset"]))for(let a of t["dcat:dataset"]){let i;a["@type"]==="DataResource"?(i=this.mapDataSetToDataResource(a),s.push(i)):(i=this.mapDataSetToSoftwareResource(a),r.push(i))}return{serviceOfferings:e,dataResources:s,softwareResources:r}})}};var bt=gt(require("axios"));var P=class extends w{toJSON(){return y(u({},super.toJSON()),{"dcat:endpointURL":this["dcat:endpointURL"],"dcat:endpointDescription":this["dcat:endpointDescription"],"dcat:servesDataset":this["dcat:servesDataset"]})}};var Z=class{constructor(t){this.url=t.url}};var tt;(t=>{class n extends Z{}t.Kind=n})(tt||(tt={}));var et=class{mapDataResourceToDataService(t){var s,r,a,i,o,c,d,p,m,g,D,f,h,S;let e=new P;if(e["@id"]=t._id,e["@type"]="DataResource",e["dcterms:title"]=t.name,e["dcterms:description"]=t.description,e["dcterms:issued"]=t.createdAt,e["dcterms:modified"]=t.updatedAt,e["dcterms:license"]=t.license,e["dcat:version"]=t.schema_version,e["odrl:hasPolicy"]=t.policy,e["dcterms:creator"]=new v.Agent({account:t.producedBy}),e["dcat:theme"]=new R.Concept({definition:t.category}),e["dcterms:rights"]=t.copyrightOwnedBy,e["dcat:endpointURL"]=t.exposedThrough,e["dcat:servesDataset"]=[],t.representation){let O=new x,l=new I;l["dcat:accessURL"]=(s=t.representation)==null?void 0:s.url,l["@id"]=(r=t.representation)==null?void 0:r._id,l["@type"]="ptx:representation",l["dcterms:issued"]=(a=t.representation)==null?void 0:a.createdAt,l["dcterms:modified"]=(i=t.representation)==null?void 0:i.updatedAt,l["dcterms:accessRights"]=(o=t.representation)==null?void 0:o.method,l["dcterms:rights"]=(c=t.representation)==null?void 0:c.credential,l["dcat:mediaType"]=(d=t.representation)==null?void 0:d.type,O["dcat:distribution"]=l,e["dcat:servesDataset"].push(O)}if(t.apiResponseRepresentation){let O=new x,l=new I;l["dcat:accessURL"]=(p=t.apiResponseRepresentation)==null?void 0:p.url,l["@id"]=(m=t.apiResponseRepresentation)==null?void 0:m._id,l["@type"]="ptx:apiResponseRepresentation",l["dcterms:issued"]=(g=t.apiResponseRepresentation)==null?void 0:g.createdAt,l["dcterms:modified"]=(D=t.apiResponseRepresentation)==null?void 0:D.updatedAt,l["dcterms:accessRights"]=(f=t.apiResponseRepresentation)==null?void 0:f.method,l["dcterms:rights"]=(h=t.apiResponseRepresentation)==null?void 0:h.credential,l["dcat:mediaType"]=(S=t.apiResponseRepresentation)==null?void 0:S.type,O["dcat:distribution"]=l,e["dcat:servesDataset"].push(O)}return e}mapSoftwareResourceToDataService(t){var r,a,i,o,c,d,p;let e=new P;e["@id"]=t._id,e["@type"]="SoftwareResource",e["dcterms:title"]=t.name,e["dcterms:description"]=t.description,e["dcterms:issued"]=t.createdAt,e["dcterms:modified"]=t.updatedAt,e["dcterms:license"]=t.license,e["dcat:version"]=t.schema_version,e["odrl:hasPolicy"]=t.policy,e["dcterms:creator"]=new v.Agent({account:t.providedBy}),e["dcat:theme"]=new R.Concept({definition:t.category}),e["dcterms:rights"]=t.copyrightOwnedBy,e["dcterms:hasPart"]=(t.aggregationOf||[]).map(m=>{let g=new x;return g["@id"]=m,g});let s=t.locationAddress.map(m=>m.countryCode);if(e["dcterms:language"]=s.join(";"),e["dcat:endpointURL"]=t.exposedThrough,e["dcat:endpointDescription"]=t.demo_link,e["dcat:servesDataset"]=[],t.representation){let m=new x,g=new I;g["dcat:accessURL"]=(r=t.representation)==null?void 0:r.url,g["@id"]=(a=t.representation)==null?void 0:a._id,g["@type"]="ptx:representation",g["dcterms:issued"]=(i=t.representation)==null?void 0:i.createdAt,g["dcterms:modified"]=(o=t.representation)==null?void 0:o.updatedAt,g["dcterms:accessRights"]=(c=t.representation)==null?void 0:c.method,g["dcterms:rights"]=(d=t.representation)==null?void 0:d.credential,g["dcat:mediaType"]=(p=t.representation)==null?void 0:p.type,m["dcat:distribution"]=g,e["dcat:servesDataset"].push(m)}return e}mapServiceOfferingToDataSet(t){return b(this,null,function*(){var a,i,o;let e=new x,s=[],r=[];for(let c of t.aggregationOf){let d=yield bt.default.get(c),p=new V;if(p["dcat:hadRole"]=d.data["@type"],p["dcterms:relation"]=c,p["dcterms:description"]=d.data.description,r.push(p),d.data.representation){let m=new I;m["dcat:accessURL"]=d.data.representation.url,m["dcat:mediaType"]=d.data.representation.fileType,m["dcat:accessService"]=d.data["@type"]==="SoftwareResource"?this.mapSoftwareResourceToDataService(d.data):d.data["@type"]==="DataResource"?this.mapDataResourceToDataService(d.data):new P,s.push(m)}if(d.data.apiResponseRepresentation){let m=new I;m["dcat:accessURL"]=d.data.apiResponseRepresentation.url,m["dcat:mediaType"]=d.data.apiResponseRepresentation.fileType,m["dcat:accessService"]=d.data["@type"]==="SoftwareResource"?this.mapSoftwareResourceToDataService(d.data):d.data["@type"]==="DataResource"?this.mapDataResourceToDataService(d.data):new P,s.push(m)}}return e["@id"]=t._id,e["@type"]="ServiceOffering",e["dcterms:title"]=(a=t.name)!=null?a:"",e["dcterms:description"]=(i=t.description)!=null?i:"",e["dcterms:identifier"]=t._id,e["odrl:hasPolicy"]=t.policy,e["dcterms:issued"]=t.createdAt,e["dcterms:modified"]=t.updatedAt,e["dcat:version"]=t.schema_version,e["dcat:keyword"]=t.keywords.join(";")&&t.category.join(";"),e["dcterms:hasPart"]=t.aggregationOf,e["dcat:distribution"]=s,e["dcat:qualifiedRelation"]=r,e["dcterms:creator"]=new v.Agent({account:(o=t.providedBy)!=null?o:""}),e["dcterms:spatial"]=t.location,e["dcat:contactPoint"]=new tt.Kind(t.dependsOn),e["dcterms:conformsTo"]=t.termsAndConditions,e})}mapServiceOfferings(t){return b(this,null,function*(){let e=[];for(let s of t)e.push(yield this.mapServiceOfferingToDataSet(s));return e})}mapResources(t,e){let s=[];for(let r of t)s.push(this.mapDataResourceToDataService(r));for(let r of e)s.push(this.mapSoftwareResourceToDataService(r));return s}mapPtxCatalogToDcatCatalog(t){return b(this,null,function*(){let e=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="serviceoffering"}),s=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="dataresource"}),r=t.filter(i=>{var o;return((o=i["@type"])==null?void 0:o.toLowerCase())==="softwareresource"}),a=new T;return a["@context"]="https://w3id.org/dspace/2024/1/context.json",a["@type"]="dcat:Catalog",a["dcat:dataset"]=yield this.mapServiceOfferings(e),a["dcat:service"]=this.mapResources(s,r),a["foaf:homepage"]="catalog/offers",a})}};var it=class{mapDataServiceToDataResource(t){var r,a,i;if(!t["@id"])throw new Error("DataService must have an @id property");let e=new C({_id:t["@id"],name:t["dcterms:title"],description:t["dcterms:description"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],license:t["dcterms:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],producedBy:(r=t["dcterms:creator"])==null?void 0:r.account,category:(a=t["dcat:theme"])==null?void 0:a.definition,copyrightOwnedBy:t["dcterms:rights"],exposedThrough:t["dcat:endpointURL"]}),s=(i=t["dcat:servesDataset"])!=null?i:[];for(let o of s){let c=o["dcat:distribution"];if(!c)continue;if(Array.isArray(c))throw new Error("Distribution cannot be an array");let d=new A({_id:c["@id"],resourceID:t["@id"],url:Array.isArray(c["dcat:accessURL"])?c["dcat:accessURL"][0]:c["dcat:accessURL"],createdAt:c["dcterms:issued"],updatedAt:c["dcterms:modified"],method:c["dcterms:accessRights"],credential:c["dcterms:rights"],type:c["dcat:mediaType"]});e.representation?e.apiResponseRepresentation||(e.apiResponseRepresentation=d):e.representation=d}return e}mapDataServiceToSoftwareResource(t){var r,a,i;if(!t["@id"])throw new Error("DataService must have an @id property");let e=new L({_id:t["@id"],name:t["dcterms:title"],description:t["dcterms:description"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],license:t["dcterms:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],providedBy:(r=t["dcterms:creator"])==null?void 0:r.account,category:(a=t["dcat:theme"])==null?void 0:a.definition,copyrightOwnedBy:t["dcterms:rights"],exposedThrough:t["dcat:endpointURL"]}),s=(i=t["dcat:servesDataset"])!=null?i:[];for(let o of s){let c=o["dcat:distribution"];if(!c)continue;if(Array.isArray(c))throw new Error("Distribution cannot be an array");let d=new A({_id:c["@id"],resourceID:t["@id"],url:Array.isArray(c["dcat:accessURL"])?c["dcat:accessURL"][0]:c["dcat:accessURL"],createdAt:c["dcterms:issued"],updatedAt:c["dcterms:modified"],method:c["dcterms:accessRights"],credential:c["dcterms:rights"],type:c["dcat:mediaType"]});e.representation||(e.representation=d)}return e}mapDataSetToServiceOffering(t){var s,r;let e=new E({_id:t["@id"],name:t["dcterms:title"],description:t["dcterms:description"],policy:t["odrl:hasPolicy"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],schema_version:t["dcat:version"],keywords:t["dcat:keyword"],aggregationOf:t["dcterms:hasPart"]});if(Array.isArray(e.aggregationOf))e.aggregationOf=e.aggregationOf.map(a=>a["@id"]);else{let a=e.aggregationOf["@id"];e.aggregationOf=[],e.aggregationOf.push(a)}return e.providedBy=(s=t["dcterms:creator"])==null?void 0:s.account,e.location=t["dcterms:spatial"],e.dependsOn=(r=t["dcat:contactPoint"])==null?void 0:r.url,e.termsAndConditions=t["dcterms:conformsTo"],e}mapDcatCatalogToPtxCatalog(t){let e=[],s=[],r=[];if(t["dcat:dataset"]&&Array.isArray(t["dcat:dataset"]))for(let a of t["dcat:dataset"]){let i=this.mapDataSetToServiceOffering(a);e.push(i)}if(t["dcat:service"]&&Array.isArray(t["dcat:service"]))for(let a of t["dcat:service"]){let i;a["@type"]==="DataResource"?(i=this.mapDataServiceToDataResource(a),s.push(i)):(i=this.mapDataServiceToSoftwareResource(a),r.push(i))}return{serviceOfferings:e,dataResources:s,softwareResources:r}}};var st=class{constructor(t){Object.assign(this,t)}};var H=class{constructor(t){Object.assign(this,t)}toJSON(){return JSON.stringify(this,null,2)}};var rt=class{mapDataOfferingToDataResource(t){var r;if(!t._id)throw new Error("DataResource must have an _id property");let e=t.policy.filter(a=>a.policy.permission.some(i=>i.action==="use")),s=t.policy.filter(a=>a.policy.permission.some(i=>i.action==="access"));return new H({"@context":{"gax-validation":"https://w3id.org/gaia-x/validation#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",sh:"http://www.w3.org/ns/shacl#",simpl:"https://w3id.org/simpl#",skos:"http://www.w3.org/2004/02/skos/core#",xsd:"http://www.w3.org/2001/XMLSchema#"},"@id":t._id,"rdf:type":{"@id":"simpl:DataOffering"},"simpl:billingSchema":{"@type":{"@id":"simpl:BillingSchema"},"simpl:billingSchemaDocument":"","simpl:billingSchemaHashAlg":"","simpl:billingSchemaHashValue":"","simpl:billingSchemaURL":""},"simpl:contractTemplate":{"@type":{"@id":"simpl:ContractTemplate"},"simpl:contractTemplateDocument":"","simpl:contractTemplateHashAlg":"","simpl:contractTemplateHashValue":"","simpl:contractTemplateURL":""},"simpl:dataProperties":{"@type":{"@id":"simpl:DataProperties"},"simpl:format":"","simpl:providerDataAddress":""},"simpl:generalServiceProperties":{"@type":{"@id":"simpl:GeneralServiceProperties"},"simpl:description":t.description||"","simpl:inLanguage":"en","simpl:name":t.name||"","simpl:offeringType":"DataOffering","simpl:serviceAccessPoint":{"@type":"xsd:anyURI","@value":t.exposedThrough||""}},"simpl:offeringPrice":{"@type":{"@id":"simpl:OfferingPrice"},"simpl:currency":"EUR","simpl:license":{"@type":"xsd:anyURI","@value":((r=t.license)==null?void 0:r[0])||""},"simpl:price":{"@type":"xsd:decimal","@value":0},"simpl:priceType":"Free"},"simpl:providerInformation":{"@type":{"@id":"simpl:ProviderInformation"},"simpl:contact":"","simpl:providedBy":t.producedBy||"","simpl:signature":""},"simpl:servicePolicy":{"@type":{"@id":"simpl:ServicePolicy"},"simpl:access-policy":JSON.stringify(s)||"","simpl:usage-policy":JSON.stringify(e)||""},"simpl:slaAgreements":{"@type":{"@id":"simpl:SlaAgreements"},"simpl:slaAgreementsDocument":"","simpl:slaAgreementsHashAlg":"","simpl:slaAgreementsHashValue":"","simpl:slaAgreementsURL":""}})}};var at=class{mapDataOfferingToDataResource(t){if(!t["@id"])throw new Error("DataOffering must have an @id property");return new C({_id:t["@id"],name:t["simpl:generalServiceProperties"]["simpl:name"],description:t["simpl:generalServiceProperties"]["simpl:description"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),license:[t["simpl:offeringPrice"]["simpl:license"]["@value"]],schema_version:"",policy:[t["simpl:servicePolicy"]["simpl:access-policy"],t["simpl:servicePolicy"]["simpl:usage-policy"]],producedBy:t["simpl:providerInformation"]["simpl:providedBy"],category:"",copyrightOwnedBy:[],exposedThrough:[t["simpl:generalServiceProperties"]["simpl:serviceAccessPoint"]["@value"]],representation:new A({_id:`${t["@id"]}_representation`,resourceID:t["@id"],type:"REST",url:t["simpl:generalServiceProperties"]["simpl:serviceAccessPoint"]["@value"],method:"none",credential:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})})}};var lt=gt(require("axios"));var k=class extends I{toJSON(){return y(u({},super.toJSON()),{"dct:format":this["dct:format"]})}};var N=class extends T{toJSON(){return y(u({},super.toJSON()),{"dspace:participantId":this["dspace:participantId"],id:this.id,isCatalog:this.isCatalog,originator:this.originator,"@context":this["@context"]})}};var U=class extends P{toJSON(){return y(u({},super.toJSON()),{"dcat:endpointUrl":this["dcat:endpointUrl"]})}};var z=class extends T{toJSON(){return u({},super.toJSON())}};var ot=class{mapResourceToDataSet(t,e){return b(this,null,function*(){var i,o,c;let s=new x,r=[];if(t.representation){let d=new k;d["dcat:accessURL"]=t.representation.url,d["dcat:mediaType"]=(i=t.representation.input)==null?void 0:i.format;let p=new U;p["@id"]=e,p["@type"]="dcat:DataService",d["dcat:accessService"]=p,r.push(d)}if(t.apiResponseRepresentation){let d=new k;d["dcat:accessURL"]=t.apiResponseRepresentation.url,d["dcat:mediaType"]=(o=t.apiResponseRepresentation.input)==null?void 0:o.format;let p=new U;p["@id"]=e,p["@type"]="dcat:DataService",d["dcat:accessService"]=p,r.push(d)}s["@id"]=t._id,s["@type"]="dcat:DataService",s["dcterms:title"]=t.name,s["dcterms:description"]=t.description,s["dcterms:issued"]=t.createdAt,s["dcterms:modified"]=t.updatedAt,s["dcterms:license"]=t.license,s["dcat:version"]=t.schema_version,s["odrl:hasPolicy"]=t.policy,s["dcterms:creator"]=new v.Agent({account:t!=null&&t.producedBy?t==null?void 0:t.producedBy:t==null?void 0:t.providedBy}),s["dcat:theme"]=new R.Concept({definition:t.category}),s["dcat:distribution"]=r,s["dcterms:rights"]=t.copyrightOwnedBy,s["dcterms:hasPart"]=(t.aggregationOf||[]).map(d=>{let p=new x;return p["@id"]=d,p});let a=(c=t==null?void 0:t.locationAddress)==null?void 0:c.map(d=>d.countryCode);return s["dcterms:language"]=a==null?void 0:a.join(";"),s})}mapServiceOfferingToSubCatalog(t){return b(this,null,function*(){let e=[],s=new N;for(let a of t.aggregationOf){let i=yield lt.default.get(a),o=yield this.mapResourceToDataSet(i.data,t==null?void 0:t._id);e.push(o)}s["@id"]=t._id,s["@type"]="dcat:Catalog",s["dcat:dataset"]=e,s["dcat:catalog"]=[],s["dcat:distribution"]=[];let r=new U;return r["@id"]=t._id,r["@type"]="dcat:DataService",s["dcat:service"]=r,s["dspace:participantId"]=t._id,s})}mapResources(t){return b(this,null,function*(){let e=[];for(let s of t)e.push(yield this.mapServiceOfferingToSubCatalog(s));return e})}mapPtxCatalogToEdcCatalog(t){return b(this,null,function*(){var d;let e=t.filter(p=>{var m;return((m=p["@type"])==null?void 0:m.toLowerCase())==="serviceoffering"}),s=e.map(p=>p.providedBy),r=[...new Set(s)];if(r.length>1)throw Error("The catalog must contain resource and offer for only one participant.");let a=e[0]["@context"].split("/v1")[0],i=yield lt.default.get(`${a}/v1/catalog/participants/${r[0]}`),o=new N;o["@id"]=i.data._id,o["@type"]="dcat:Catalog",o["@type"]="dcat:Catalog",o["dcat:dataset"]=new z;let c=new U;return c["@id"]="ptx:catalog",c["@type"]="dcat:DataService",c["dcat:endpointDescription"]="dspace:catalog",c["dcat:endpointURL"]=i.data.dataspaceEndpoint,c["dcat:endpointUrl"]=i.data.dataspaceEndpoint,o["dcat:catalog"]=yield this.mapResources(e),o["dcat:distribution"]=[],o["dcat:service"]=c,o["dspace:participantId"]=(d=i.data.did)!=null?d:i.data._id,o.originator=i.data.dataspaceEndpoint,o["@context"]={dcat:"http://www.w3.org/ns/dcat#",dct:"http://purl.org/dc/terms/",odrl:"http://www.w3.org/ns/odrl/2/",dspace:"https://w3id.org/dspace/v0.8/","@vocab":"https://w3id.org/edc/v0.0.1/ns/",edc:"https://w3id.org/edc/v0.0.1/ns/"},o})}};var nt=class{mapDatasetToResource(t,e){var i,o,c,d,p,m,g;let s=Array.isArray(t["dcat:distribution"])?t["dcat:distribution"]:[],r=[],a=[];for(let D of s){let f,h=D["dcat:accessURL"]||(e==null?void 0:e["dcat:endpointURL"])||(e==null?void 0:e["dcat:endpointUrl"]);h&&(D["dct:format"]&&D["dct:format"]["@id"]==="HttpData-PULL"?(f={_id:`${t["@id"]}`,name:t["dcterms:title"],description:t["dcterms:description"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],license:t["dcterms:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],copyrightOwnedBy:t["dcterms:rights"],category:(i=t["dcat:theme"])==null?void 0:i.definition,producedBy:(o=t["dcterms:creator"])==null?void 0:o.account,representation:{url:h,input:{format:D["dcat:mediaType"]}}},r.push(f)):D["dct:format"]&&D["dct:format"]["@id"]==="HttpData-PUSH"?(f={_id:`${t["@id"]}`,name:t["dcterms:title"],description:t["dcterms:description"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],license:t["dcterms:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],copyrightOwnedBy:t["dcterms:rights"],category:(c=t["dcat:theme"])==null?void 0:c.definition,providedBy:(d=t["dcterms:creator"])==null?void 0:d.account,representation:{url:h,input:{format:D["dcat:mediaType"]}},aggregationOf:Array.isArray(t["dcterms:hasPart"])?t["dcterms:hasPart"].map(S=>S["@id"]):[],locationAddress:((p=t["dcterms:language"])==null?void 0:p.split(";").map(S=>({countryCode:S})))||[]},a.push(f)):(f={_id:t["@id"],name:t["dcterms:title"],description:t["dcterms:description"],createdAt:t["dcterms:issued"],updatedAt:t["dcterms:modified"],license:t["dcterms:license"],schema_version:t["dcat:version"],policy:t["odrl:hasPolicy"],copyrightOwnedBy:t["dcterms:rights"],category:(m=t["dcat:theme"])==null?void 0:m.definition,producedBy:(g=t["dcterms:creator"])==null?void 0:g.account,representation:{url:h,input:{format:D["dcat:mediaType"]}}},r.push(f)))}return{dataResources:r,softwareResources:a}}mapCatalogToServiceOffering(t){let e=t["dcat:service"],s=Array.isArray(t["dcat:dataset"])?t["dcat:dataset"]:[];return{_id:t["@id"],name:(e==null?void 0:e["dcat:endpointDescription"])||"Service Offering",description:"Service Offering from EDC Catalog",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),providedBy:t["dspace:participantId"],aggregationOf:s.map(r=>r["@id"])}}mapEdcCatalogToPtxCatalog(t){let e=[],s=[],r=[],a=Array.isArray(t["dcat:catalog"])?t["dcat:catalog"]:[];for(let i of a){let o=this.mapCatalogToServiceOffering(i);e.push(o);let c=Array.isArray(i["dcat:dataset"])?i["dcat:dataset"]:[];for(let d of c){let p=Array.isArray(i["dcat:service"])?i["dcat:service"][0]:i["dcat:service"],{dataResources:m,softwareResources:g}=this.mapDatasetToResource(d,p);s.push(...m),r.push(...g)}}return{serviceOfferings:e,dataResources:s,softwareResources:r}}};var ct=class{constructor(t){Object.assign(this,t)}toJSON(){return{endpoint:this.endpoint,resourceId:this.resourceId,type:this.type,enabled:this.enabled}}};var dt=class{constructor(t){Object.assign(this,t)}toJSON(){return{"gx:providedBy":this["gx:providedBy"],"gx:consumedBy":this["gx:consumedBy"],"gx:dataProduct":this["gx:dataProduct"],"gx:signers":this["gx:signers"].map(t=>t.toJSON()),"gx:termOfUsage":this["gx:termOfUsage"],"gx:notarizedIn":this["gx:notarizedIn"],"gx:dataUsage":this["gx:dataUsage"]}}};var pt=class{constructor(t){Object.assign(this,t)}toJSON(){return{"gx:dataProductUsageContract":this["gx:dataProductUsageContract"],"gx:dataUsage":this["gx:dataUsage"]}}};var mt=class{};0&&(module.exports={Catalog,Checksum,ContractTemplate,DSPDistribution,DataCatalog,DataOffering,DataProduct,DataProductUsageContract,DataRepresentation,DataResource,DataSet,DataTransaction,DcatToPtxConvertor,Distribution,EdcCatalog,EdcDataService,EdcDataset,EdcDistribution,EdcToPtxConvertor,GaiaXToPtxConvertor,PtxToDcatConvertor,PtxToEdcConvertor,PtxToGaiaXConvertor,PtxToSimplConvertor,Resource,ServiceOffering,SimplToPtxConvertor,SoftwareResource});
//# sourceMappingURL=index.js.map